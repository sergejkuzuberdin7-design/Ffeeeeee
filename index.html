<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoGame - Экономическая игра с выводом</title>
    <style>
        :root {
            --primary: #2ecc71;
            --secondary: #3498db;
            --accent: #e74c3c;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 20px;
            background: rgba(44, 62, 80, 0.9);
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .user-panel {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(44, 62, 80, 0.9);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }
        
        .balance {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .balance-amount {
            color: var(--primary);
        }
        
        .actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: var(--shadow);
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-secondary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-accent {
            background: var(--accent);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 8px rgba(0,0,0,0.15);
        }
        
        .game-area {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .businesses {
            background: rgba(44, 62, 80, 0.9);
            padding: 20px;
            border-radius: 15px;
            box-shadow: var(--shadow);
        }
        
        .business {
            background: rgba(52, 73, 94, 0.7);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .business-info h3 {
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .business-stats {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }
        
        .stat {
            background: rgba(44, 62, 80, 0.7);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.9rem;
        }
        
        .upgrades {
            background: rgba(44, 62, 80, 0.9);
            padding: 20px;
            border-radius: 15px;
            box-shadow: var(--shadow);
        }
        
        .upgrade {
            background: rgba(52, 73, 94, 0.7);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .upgrade-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .upgrade-price {
            color: var(--primary);
            font-weight: bold;
        }
        
        .progress-bar {
            height: 10px;
            background: rgba(44, 62, 80, 0.7);
            border-radius: 5px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.5s;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: var(--dark);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: var(--shadow);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .close {
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: none;
            background: rgba(255,255,255,0.1);
            color: var(--light);
        }
        
        .payment-methods {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
        }
        
        .payment-method {
            background: rgba(52, 73, 94, 0.7);
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .payment-method.active {
            background: var(--primary);
        }
        
        .requisites {
            background: rgba(52, 73, 94, 0.7);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: monospace;
            word-break: break-all;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background: rgba(44, 62, 80, 0.9);
            border-radius: 15px;
            box-shadow: var(--shadow);
        }
        
        @media (max-width: 768px) {
            .game-area {
                grid-template-columns: 1fr;
            }
            
            .payment-methods {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>EcoGame</h1>
            <p>Экономическая стратегия с реальным выводом средств</p>
        </header>
        
        <div class="user-panel">
            <div class="balance">
                Баланс: <span class="balance-amount" id="balance">1,000.00</span> руб.
            </div>
            <div class="actions">
                <button class="btn btn-primary" onclick="showDepositModal()">Пополнить</button>
                <button class="btn btn-secondary" onclick="showWithdrawModal()">Вывести</button>
                <button class="btn btn-accent" onclick="showReferralModal()">Рефералы</button>
            </div>
        </div>
        
        <div class="game-area">
            <div class="businesses">
                <h2>Ваши бизнесы</h2>
                <div class="business">
                    <div class="business-info">
                        <h3>Небольшой магазин</h3>
                        <p>Прибыль: 10 руб/час</p>
                        <div class="business-stats">
                            <div class="stat">Уровень: 1</div>
                            <div class="stat">Доход: 10 руб/ч</div>
                            <div class="stat">Количество: 1</div>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="upgradeBusiness('shop')">Улучшить (500 руб)</button>
                </div>
                
                <div class="business">
                    <div class="business-info">
                        <h3>Кафе</h3>
                        <p>Прибыль: 50 руб/час</p>
                        <div class="business-stats">
                            <div class="stat">Уровень: 0</div>
                            <div class="stat">Доход: 50 руб/ч</div>
                            <div class="stat">Количество: 0</div>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="buyBusiness('cafe')">Купить (2,000 руб)</button>
                </div>
                
                <div class="business">
                    <div class="business-info">
                        <h3>Автосервис</h3>
                        <p>Прибыль: 200 руб/час</p>
                        <div class="business-stats">
                            <div class="stat">Уровень: 0</div>
                            <div class="stat">Доход: 200 руб/ч</div>
                            <div class="stat">Количество: 0</div>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="buyBusiness('service')">Купить (10,000 руб)</button>
                </div>
            </div>
            
            <div class="upgrades">
                <h2>Улучшения</h2>
                <div class="upgrade">
                    <div class="upgrade-header">
                        <h3>Менеджер</h3>
                        <span class="upgrade-price">1,000 руб</span>
                    </div>
                    <p>Автоматически собирает доход каждые 24 часа</p>
                    <button class="btn btn-secondary" onclick="buyUpgrade('manager')">Купить</button>
                </div>
                
                <div class="upgrade">
                    <div class="upgrade-header">
                        <h3>Бустер дохода</h3>
                        <span class="upgrade-price">5,000 руб</span>
                    </div>
                    <p>Увеличивает доход от всех бизнесов на 25%</p>
                    <button class="btn btn-secondary" onclick="buyUpgrade('booster')">Купить</button>
                </div>
                
                <div class="upgrade">
                    <div class="upgrade-header">
                        <h3>Автоматизация</h3>
                        <span class="upgrade-price">10,000 руб</span>
                    </div>
                    <p>Увеличивает скорость получения дохода в 2 раза</p>
                    <div class="progress-bar">
                        <div class="progress" id="automation-progress"></div>
                    </div>
                    <button class="btn btn-secondary" onclick="buyUpgrade('automation')">Улучшить</button>
                </div>
            </div>
        </div>
        
        <!-- Модальное окно пополнения -->
        <div class="modal" id="depositModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Пополнение баланса</h2>
                    <span class="close" onclick="closeModal('depositModal')">&times;</span>
                </div>
                <div class="form-group">
                    <label for="depositAmount">Сумма пополнения (руб)</label>
                    <input type="number" id="depositAmount" min="100" value="1000">
                </div>
                <div class="form-group">
                    <label>Выберите способ оплаты</label>
                    <div class="payment-methods">
                        <div class="payment-method active" data-method="ton">TON</div>
                        <div class="payment-method" data-method="yoomoney">ЮMoney</div>
                        <div class="payment-method" data-method="btc">Bitcoin</div>
                    </div>
                </div>
                <div class="requisites" id="depositRequisites">
                    TON: UQB3VJp6X0Y7f8gHk9LmN2oPqR5sT7wE1zC4xV6bA8yD9
                </div>
                <button class="btn btn-primary" onclick="confirmDeposit()">Я перевел</button>
            </div>
        </div>
        
        <!-- Модальное окно вывода -->
        <div class="modal" id="withdrawModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Вывод средств</h2>
                    <span class="close" onclick="closeModal('withdrawModal')">&times;</span>
                </div>
                <div class="form-group">
                    <label for="withdrawAmount">Сумма вывода (руб)</label>
                    <input type="number" id="withdrawAmount" min="100" value="1000">
                </div>
                <div class="form-group">
                    <label>Выберите способ вывода</label>
                    <div class="payment-methods">
                        <div class="payment-method active" data-method="ton">TON</div>
                        <div class="payment-method" data-method="yoomoney">ЮMoney</div>
                        <div class="payment-method" data-method="btc">Bitcoin</div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="withdrawDetails">Ваши реквизиты</label>
                    <input type="text" id="withdrawDetails" placeholder="Введите реквизиты для вывода">
                </div>
                <button class="btn btn-secondary" onclick="confirmWithdraw()">Вывести</button>
            </div>
        </div>
        
        <!-- Модальное окно рефералов -->
        <div class="modal" id="referralModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Реферальная система</h2>
                    <span class="close" onclick="closeModal('referralModal')">&times;</span>
                </div>
                <div class="form-group">
                    <label>Ваша реферальная ссылка</label>
                    <div class="requisites" id="referralLink">
                        https://ecogame.example.com/?ref=USER12345
                    </div>
                </div>
                <div class="form-group">
                    <p>Приглашайте друзей и получайте 10% от их пополнений!</p>
                </div>
                <div class="form-group">
                    <h3>Ваши рефералы</h3>
                    <div id="referralsList">
                        <p>Пока нет приглашенных друзей</p>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>EcoGame &copy; 2023 | Все права защищены</p>
            <p>По вопросам сотрудничества: partner@ecogame.example.com</p>
        </footer>
    </div>

    <script>
        // Игровые данные
        let gameData = {
            balance: 1000,
            businesses: {
                shop: { level: 1, count: 1, income: 10 },
                cafe: { level: 0, count: 0, income: 50 },
                service: { level: 0, count: 0, income: 200 }
            },
            upgrades: {
                manager: false,
                booster: false,
                automation: 0
            },
            lastIncomeTime: Date.now(),
            currentPaymentMethod: 'ton'
        };

        // Инициализация игры
        document.addEventListener('DOMContentLoaded', function() {
            // Загрузка данных из localStorage
            const savedData = localStorage.getItem('ecoGameData');
            if (savedData) {
                gameData = JSON.parse(savedData);
                updateUI();
            }
            
            // Обработчики для выбора способа оплаты
            document.querySelectorAll('.payment-method').forEach(method => {
                method.addEventListener('click', function() {
                    document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('active'));
                    this.classList.add('active');
                    gameData.currentPaymentMethod = this.getAttribute('data-method');
                    updateRequisites();
                });
            });
            
            // Запуск игрового цикла
            setInterval(gameLoop, 1000);
            
            // Обновление UI
            updateUI();
        });

        // Игровой цикл
        function gameLoop() {
            const now = Date.now();
            const timePassed = (now - gameData.lastIncomeTime) / 1000; // в секундах
            
            if (timePassed >= 1) {
                // Расчет дохода
                let incomePerSecond = calculateIncomePerSecond();
                const income = incomePerSecond * timePassed;
                
                gameData.balance += income;
                gameData.lastIncomeTime = now;
                
                // Сохранение и обновление UI
                saveGame();
                updateUI();
            }
        }

        // Расчет дохода в секунду
        function calculateIncomePerSecond() {
            let income = 0;
            
            // Доход от бизнесов
            for (const business in gameData.businesses) {
                const b = gameData.businesses[business];
                income += b.count * b.income * (b.level * 0.5 + 1);
            }
            
            // Применение улучшений
            if (gameData.upgrades.booster) income *= 1.25;
            if (gameData.upgrades.automation > 0) income *= (1 + gameData.upgrades.automation * 0.5);
            
            // Перевод в доход в секунду (изначально в час)
            return income / 3600;
        }

        // Покупка бизнеса
        function buyBusiness(type) {
            const prices = {
                cafe: 2000,
                service: 10000
            };
            
            const price = prices[type];
            
            if (gameData.balance >= price) {
                gameData.balance -= price;
                gameData.businesses[type].count += 1;
                saveGame();
                updateUI();
                alert(`Вы успешно купили бизнес!`);
            } else {
                alert(`Недостаточно средств! Нужно ${price} руб.`);
            }
        }

        // Улучшение бизнеса
        function upgradeBusiness(type) {
            const price = 500 * gameData.businesses[type].level;
            
            if (gameData.balance >= price) {
                gameData.balance -= price;
                gameData.businesses[type].level += 1;
                saveGame();
                updateUI();
                alert(`Бизнес улучшен до уровня ${gameData.businesses[type].level}!`);
            } else {
                alert(`Недостаточно средств! Нужно ${price} руб.`);
            }
        }

        // Покупка улучшений
        function buyUpgrade(type) {
            const prices = {
                manager: 1000,
                booster: 5000,
                automation: 10000 * (gameData.upgrades.automation + 1)
            };
            
            const price = prices[type];
            
            if (gameData.balance >= price) {
                gameData.balance -= price;
                
                if (type === 'automation') {
                    gameData.upgrades.automation += 1;
                } else {
                    gameData.upgrades[type] = true;
                }
                
                saveGame();
                updateUI();
                alert(`Улучшение "${type}" приобретено!`);
            } else {
                alert(`Недостаточно средств! Нужно ${price} руб.`);
            }
        }

        // Показ модального окна пополнения
        function showDepositModal() {
            document.getElementById('depositModal').style.display = 'flex';
            document.getElementById('depositAmount').value = 1000;
            updateRequisites();
        }

        // Показ модального окна вывода
        function showWithdrawModal() {
            document.getElementById('withdrawModal').style.display = 'flex';
            document.getElementById('withdrawAmount').value = 1000;
            document.getElementById('withdrawDetails').value = '';
        }

        // Показ модального окна рефералов
        function showReferralModal() {
            document.getElementById('referralModal').style.display = 'flex';
        }

        // Закрытие модального окна
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Обновление реквизитов
        function updateRequisites() {
            const requisitesElement = document.getElementById('depositRequisites');
            switch(gameData.currentPaymentMethod) {
                case 'ton':
                    requisitesElement.textContent = 'TON: UQB3VJp6X0Y7f8gHk9LmN2oPqR5sT7wE1zC4xV6bA8yD9';
                    break;
                case 'yoomoney':
                    requisitesElement.textContent = 'ЮMoney: 4100112356789012';
                    break;
                case 'btc':
                    requisitesElement.textContent = 'Bitcoin: bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh';
                    break;
            }
        }

        // Подтверждение пополнения
        function confirmDeposit() {
            const amount = parseInt(document.getElementById('depositAmount').value);
            
            if (amount < 100) {
                alert('Минимальная сумма пополнения - 100 руб');
                return;
            }
            
            // В реальном приложении здесь будет отправка уведомления администратору
            const message = `НОВАЯ ЗАЯВКА: ПОПОЛНЕНИЕ ${amount} RUB через ${gameData.currentPaymentMethod.toUpperCase()}`;
            sendToAdmin(message);
            
            alert(`Заявка на пополнение ${amount} руб отправлена. Ожидайте подтверждения.`);
            closeModal('depositModal');
        }

        // Подтверждение вывода
        function confirmWithdraw() {
            const amount = parseInt(document.getElementById('withdrawAmount').value);
            const details = document.getElementById('withdrawDetails').value;
            
            if (amount < 100) {
                alert('Минимальная сумма вывода - 100 руб');
                return;
            }
            
            if (amount > gameData.balance) {
                alert('Недостаточно средств на балансе');
                return;
            }
            
            if (!details) {
                alert('Введите реквизиты для вывода');
                return;
            }
            
            // В реальном приложении здесь будет отправка уведомления администратору
            const message = `НОВАЯ ЗАЯВКА: ВЫВОД ${amount} RUB на ${gameData.currentPaymentMethod.toUpperCase()}: ${details}`;
            sendToAdmin(message);
            
            // В реальном приложении баланс будет списываться после подтверждения администратором
            // gameData.balance -= amount;
            
            alert(`Заявка на вывод ${amount} руб отправлена. Ожидайте обработки.`);
            closeModal('withdrawModal');
        }

        // Отправка уведомления администратору
        function sendToAdmin(message) {
            // В реальном приложении здесь будет запрос к API Telegram бота
            console.log('Отправка администратору:', message);
            
            // Пример реализации с Telegram Bot API:
            // const botToken = 'YOUR_BOT_TOKEN';
            // const adminId = 'ADMIN_CHAT_ID';
            // fetch(`https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${adminId}&text=${encodeURIComponent(message)}`)
            //   .then(response => response.json())
            //   .then(data => console.log('Уведомление отправлено'))
            //   .catch(error => console.error('Ошибка отправки:', error));
        }

        // Сохранение игры
        function saveGame() {
            localStorage.setItem('ecoGameData', JSON.stringify(gameData));
        }

        // Обновление интерфейса
        function updateUI() {
            // Обновление баланса
            document.getElementById('balance').textContent = gameData.balance.toFixed(2);
            
            // Обновление прогресса автоматизации
            document.getElementById('automation-progress').style.width = 
                (gameData.upgrades.automation / 5 * 100) + '%';
        }

        // Обработка кликов вне модального окна
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }
    </script>
</body>
</html>
